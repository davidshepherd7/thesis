
\section{Verification of midpoint method properties}

\subsection{Calculation of effective damping constant}
\label{sec:exact-damp-const}

In the midpoint method the effective damping (\ie the damping corresponding to the actual energy loss) should be exactly the same as the prescribed damping constant.
Effective damping for constant applied field can be computed by a rearrangement of the LLG and

\begin{equation}
  \pd{e}{t} = \pd{}{t} \left[ - \int_\magd \heff \cdot \mv \d \magd \right] = - \int_\magd \heff \cdot \pd{\mv}{t} \d \magd,
\end{equation}

The result as given by Albuquerque \etal \cite{Albuquerque2001} is

\begin{equation}
  \dampeff = - \frac{1}{M_s^2} \pd{e}{t}  \left( \pd{\mv}{t} \right)^{-2}.
\end{equation}


The time derivative of the energy can be calculated either by directly ``finite differencing'' the energy or by analytical calculation of the derivative.
We prefer analytical calculations for their increased accuracy (and speed\footnote{Calculating analytically only requires one function integral evaluation rather than the 2 or more needed to get the data points needed for finite differences.}).

The energy derivatives with respect to time in non-dimensionalised units (see Section~\ref{sec:energy-calculations}) are given by

\begin{align}
  \pd{\eapp}{t} &= - \int_\magd \pd{\mv}{t} \cdot \happ \d\magd, \\
  %
  \pd{\eex}{t} &= \int_\magd \nabla m_x \cdot \nabla \pd{m_x}{t}
           + \nabla m_y \cdot \nabla \pd{m_y}{t}
           + \nabla m_z \cdot \nabla \pd{m_z}{t} \d\magd, \\
  %
  \pd{\eca}{t} &= - \kone \int_\magd (\mv \cdot \ev )\, (\pd{\mv}{t} \cdot \ev) \d\magd, \\
  %
  \pd{\ems}{t} &= \frac{1}{2} \int_\magd \pd{\mv}{t} \cdot \nabla \phim
       + \mv \cdot \nabla \pd{\phim}{t} \d\magd.
\end{align}

Note the sign in $\pd{\ems}{t}$. There are two factors of $-1$: from the energy itself and from $\hms = - \nabla \phim$.

Calculating these integrals using the same machinery as used for the main calculations ensures that the accuracy of $\dampeff$ is of the same order as the accuracy of the model. ??ds which isn't good enough!!!

Actually it looks like we need to finite difference it...

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "./main"
%%% End:
